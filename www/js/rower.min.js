!function(e){e.fn.rower=function(t){var n=e.extend({templateSelector:".rower-template",rowSelector:".form-row",removeSelector:'button[name$="[remove]"]',addButtonClass:"btn btn-secondary",addButtonText:"Add new row",placeholder:"__index__",onInsert:void 0},t),r=function(t){t.each(function(t){e(this).find(":input").attr("name",function(){if(void 0!==e(this).attr("name"))return e(this).attr("name").replace(/\[[^\]]+\]/,"["+t+"]")})})};return e(this).each(function(){var t=e(this),o=e(document.createElement("span")).addClass(n.addButtonClass).text(n.addButtonText),a=t.find(n.templateSelector);t.on("click",n.removeSelector,function(a){a.preventDefault(),e(this).closest(n.rowSelector).fadeOut(250,function(){e(this).detach();var a=t.find(n.rowSelector);!a.length&&o.fadeIn()||r(a)})}),t.append(o),t.on("keyup",n.rowSelector+":last",function(t){e(this).find(":input").serializeArray().map(function(e){return e.value}).join("").length}),t.find(n.rowSelector+":last :input").serializeArray().map(function(e){return e.value}).join("").length,o.on("click",function(r){r.preventDefault();var o=e(a.html().replace(new RegExp(n.placeholder,"g"),t.find(n.rowSelector).length));e(this).before(o),"function"==typeof n.onInsert&&n.onInsert(o)})}),this}}(jQuery);